<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EcoPackAI - Packaging Recommendation</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{margin:0;font-family:Segoe UI,system-ui;background:#f4f6f8}
.app{display:flex;min-height:100vh}
.sidebar{width:240px;background:#1b5e20;color:#fff;padding:20px}
.brand{font-size:24px;font-weight:700;margin-bottom:30px}
.menu a{display:block;color:#fff;text-decoration:none;padding:10px 14px;border-radius:6px;margin-bottom:6px}
.menu a.active,.menu a:hover{background:rgba(255,255,255,.25)}
.main{flex:1;padding:28px}
.page-title{font-size:28px;font-weight:700;color:#1b5e20}
.subtitle{color:#666;margin-bottom:20px}
.card{background:#fff;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.08);padding:28px}
.form-label{font-weight:600}
.btn-primary{background:#1b5e20;border:none;padding:10px 20px}
.btn-primary:hover{background:#2e7d32}
</style>
</head>

<body>
<div class="app">

<!-- Sidebar -->
<div class="sidebar">
  <div class="brand">EcoPackAI</div>
  <div class="menu">
    <a href="/dashboard" class="active">Dashboard</a>
    <a href="/analytics">Analytics</a>
    <a href="/history">History</a>
    <a href="/logout">Logout</a>
  </div>
</div>

<!-- Main -->
<div class="main">

<div class="page-title">Packaging Recommendation</div>
<div class="subtitle">Use AI to find optimal eco-friendly packaging</div>

<div class="card">

<h4 class="text-success mb-4">Enter Food Details</h4>

<form id="predictForm">

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">Food Category</label>
    <select class="form-select" name="food_category" required>
      <option>Beverages</option>
      <option>Fresh Produce</option>
      <option>Dairy</option>
      <option>Ready to Eat</option>
      <option>Bakery</option>
      <option>Meat and Seafood</option>
      <option>Dry Food</option>
    </select>
  </div>
  <div class="col-md-6">
    <label class="form-label">Food Name</label>
    <input class="form-control" name="food_name">
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">Strength Requirement</label>
    <input type="number" class="form-control" name="strength" required>
  </div>
  <div class="col-md-6">
    <label class="form-label">Moisture Resistance</label>
    <input type="number" class="form-control" name="moisture_resistance" required>
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">Weight Capacity </label>
    <input type="number" class="form-control" name="weight_capacity" required>
  </div>
  <div class="col-md-6">
    <label class="form-label">Food Safety </label>
    <input type="number" class="form-control" name="food_safety" required>
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">Target Shelf Life </label>
    <input type="number" class="form-control" name="shelf_life" required>
  </div>
  <div class="col-md-6">
    <label class="form-label">Mode of Transport</label>
    <select class="form-select" name="transport_mode" required>
      <option>Local</option>
      <option>National</option>
      <option>Export</option>
    </select>
  </div>
</div>

<div class="mb-4">
  <label class="form-label">Packaging Weight</label>
  <input type="number" class="form-control" name="packaging_weight">
</div>

<button type="submit" class="btn btn-primary">Predict Material</button>

</form>

<hr class="my-4">

<h4 class="text-success">Recommended Packaging Material</h4>
<div class="alert alert-success fw-bold">
Predicted Material: <span id="predictedMaterial">—</span>
</div>

<h6 class="mt-3 text-secondary">Other Suitable Options</h6>
<ul class="list-group mb-3" id="alternativeList"></ul>

<div class="row mt-4">
  <div class="col-md-6">
    <h6>Cost Comparison</h6>
    <canvas id="costChart"></canvas>
  </div>
  <div class="col-md-6">
    <h6>CO₂ Emission Comparison</h6>
    <canvas id="co2Chart"></canvas>
  </div>
</div>

</div>
</div>
</div>

<script>
let costChart, co2Chart;

document.getElementById("predictForm").addEventListener("submit", async function(e){
e.preventDefault();

const formData = new FormData(this);
const payload = Object.fromEntries(formData.entries());

["strength","weight_capacity","moisture_resistance","food_safety","shelf_life","packaging_weight"]
.forEach(k => payload[k] = payload[k] ? Number(payload[k]) : null);

const res = await fetch("/recommend", {
  method:"POST",
  headers:{ "Content-Type":"application/json" },
  body: JSON.stringify(payload)
});

const data = await res.json();

if(data.error){
  alert(data.error);
  return;
}

document.getElementById("predictedMaterial").innerText = data.recommended_material;

const altList = document.getElementById("alternativeList");
altList.innerHTML = "";

data.alternatives.forEach((item, idx) => {
  if(idx === 0) return; // skip the main predicted one
  const li = document.createElement("li");
  li.className = "list-group-item";
  li.innerText = `${item.material} — Cost: ₹${item.cost}, CO₂: ${item.co2}`;
  altList.appendChild(li);
});

const labels = data.ranking.map(r=>r.material);
const costs = data.ranking.map(r=>r.cost);
const co2 = data.ranking.map(r=>r.co2);

if(costChart) costChart.destroy();
if(co2Chart) co2Chart.destroy();

costChart = new Chart(document.getElementById("costChart"), {
type:"bar",
data:{labels,datasets:[{label:"Cost",data:costs,backgroundColor:"#1b5e20"}]}
});

co2Chart = new Chart(document.getElementById("co2Chart"), {
type:"bar",
data:{labels,datasets:[{label:"CO₂",data:co2,backgroundColor:"#c62828"}]}
});
});
</script>

</body>
</html>
